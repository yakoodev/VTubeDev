# B2_1 — On-demand activation: render/encode только при потребителях

**Status:** todo

## Цель

Реализовать on-demand поведение: форматы активны только при наличии потребителей (viewer/stream/window/replay buffer).

## Контекст / ссылки

- `docs/vtube-mvp.md` (On-demand)

## Объём

**Включено:**

- Учёт активных потребителей (view/stream/window/bufferize)
- Статус активности формата
- Остановка рендера/кодирования при отсутствии спроса

**Не включено:**

- Автоматическое масштабирование качества
- Priority scheduling

## Шаги реализации

1. Ввести счётчик потребителей на formatId/profile.
2. Переключать active state при появлении/исчезновении клиентов.
3. Привязать рендер/encode к active state.

## Критерии приёмки

- [ ] При отсутствии потребителей рендер/encode не выполняются.
- [ ] При подключении клиента формат активируется.

## Как проверить

- Подключить/отключить `/stream` и смотреть логи активности.
- Включить `bufferize=true` и убедиться, что формат активен без клиентов.

## Артефакты

- Активатор форматов
- Логи/метрики активности
